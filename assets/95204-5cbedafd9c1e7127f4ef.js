"use strict";(self.webpackChunkdoctolib=self.webpackChunkdoctolib||[]).push([[95204],{725651:(e,t,n)=>{n.d(t,{Z:()=>p});var i=n(551663),o=n(469430),r=n(736820),a=n(294184),s=n.n(a),c=n(920700),l=n(198900),d=n(10802),u=(n(737611),n(785893));const p=e=>{let{className:t,title:n,titleComponent:a,alignLeft:p,translucid:f,subtitle:h,large:v,children:m,uiStyle:y,steps:g,isMainTitle:w,isSmallTitle:_,onBack:b,onClose:k,onClickNavbarTitle:x,safeArea:Z=!0,...P}=e;const C=s()("dl-nav-bar",{"dl-nav-bar-translucid":f,"dl-nav-bar-with-subtitle":h,"dl-nav-bar-large":v||g,"dl-nav-bar-with-stepper":g,"dl-nav-bar-ios dl-padding-t-safe-area":d.jv&&Z,["dl-nav-bar-".concat(y)]:y},t),E=g?(0,u.jsxs)("div",{children:[n,(0,u.jsx)(l.Z,{current:g.current,total:g.total})]}):n;return(0,u.jsxs)("nav",{className:C,...P,children:[E?(0,u.jsx)(r.Z,{className:s()("dl-nav-bar-title",{"dl-text-left":p,"dl-nav-bar-title-auto":p,"dl-nav-bar-main-title":w,"dl-nav-bar-title-small":_,"dl-nav-bar-title-no-steps":!g}),"aria-live":"polite",uiStyle:w?"title-l-bold":"title-s-bold",align:w?"left":"center",color:"white",onClick:x,component:a,children:E}):null,h?(0,u.jsx)("div",{className:"dl-nav-bar-subtitle",children:h}):null,b?(0,u.jsx)(c.Z,{icon:(0,u.jsx)(o.Z,{name:"chevron-left",color:"white",size:"medium"}),title:i.Z.t("common.actions.back"),position:"left",onTap:b}):null,k?(0,u.jsx)(c.Z,{title:i.Z.t("common.actions.close"),icon:(0,u.jsx)(o.Z,{name:"close",color:"white",size:"medium"}),position:"right",onTap:k}):null,m]})}},617374:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(294184),o=n.n(i),r=n(578682),a=(n(343605),n(785893));const s=e=>{let{className:t,disabled:n,item:i,onOpen:s,...c}=e;return(0,a.jsx)(r.Z,{className:o()(t,"dl-selector-label",{"dc-text-input-disabled":n}),disabled:n,onClick:n?()=>({}):s,onFocus:n?()=>({}):s,readOnly:!0,value:(null===i||void 0===i?void 0:i.inputPlaceholderWhenSelected)||(null===i||void 0===i?void 0:i.label)||"",...c})}},667745:(e,t,n)=>{n.d(t,{Z:()=>V});var i=n(667294),o=n(957557),r=n.n(o),a=n(551663),s=n(294184),c=n.n(s),l=n(391207),d=(n(21374),n(612186)),u=n(657577),p=n(884293),f=n(426214),h=n(552034),v=n.n(h),m=n(972459),y=n(614035),g=n.n(y),w=n(481094),_=n(768593),b=n(558613),k=n(934474),x=n.n(k),Z=n(434213),P=n.n(Z),C=n(138542),E=n(240238),I=n(808514),j=n(536212),S=n(785893);const R=(0,i.forwardRef)(((e,t)=>(0,S.jsx)(v(),{options:{phone:!0,phoneRegionCode:g()((0,m.rZ)())},...e,ref:t,onInit:j.Z}))),T={email:f.Z,tel:e=>(0,d.qh)((0,m.rZ)(),e)},N=["crucial_info","notes","detailled_feedback"],D=e=>N.includes(null===e||void 0===e?void 0:e.id)||N.includes(null===e||void 0===e?void 0:e.fieldName),M=e=>{let{autosize:t,multiline:n,className:o,uiStyle:s,type:l="text",focused:d,icon:p,iconPosition:f="left",onChange:h,onBlur:v,onFocus:m,fieldApi:y,validate:g,inputButton:k,minLength:Z,maxLength:j,value:N,formConfig:{validityIndicators:M,requiredIndicators:V},hideValidityIndicator:O,noDrop:W=!1,noPaste:F=!1,dontSetFormApiError:q,autoComplete:A,forwardedRef:z,trackingId:U,trackingCallback:L,...B}=e;const[X,G]=(0,i.useState)({inputType:l});(0,i.useEffect)((()=>{"date"===l&&(0,w.Z)()}),[]);const{inputType:Y}=X;let K;K=t?I.Z:n?"textarea":"tel"===l?R:"input";const Q="text"===Y?P():x(),J="password"===l,H=c()("dl-input-container",{["dl-input-container-icon-position-".concat(f)]:p,"dl-input-container-filled":!!y.value,"dl-input-container-icon-position-right":J,"dl-display-flex":t}),$=c()("dc-input","dc-text-input",o,{"dl-input-date":"date"===l,["dl-input-".concat(s)]:s,"dl-input-multiline":n,"dl-input-autosize":t,"dl-input-focused":d,"dl-input-with-icon":p,"dl-input-validation-error":y.touched&&y.error?"error":null,"dl-input-validation-warning":y.touched&&y.warning?"warning":null,"dc-text-input-disabled":B.disabled||B.readOnly,"dl-text-input-bordered":B.bordered});!n&&B.required&&"text"===l&&(B.pattern=".*?\\S.*",B.title=B.title||a.Z.t("common.fields.cannot_be_blank"));const ee=!y.error,te=!M||O||B.disabled||B.readOnly?null:(0,S.jsx)(u.Z,{required:V&&B.required,value:y.value,valid:ee,pristine:!y.touched}),ne=e=>{const{target:{value:t}}=e;if(y.setValue(t),!q){const e=T[l];Z&&t?y.setError(t.length<Z):j&&t?y.setError(t.length>j):t&&e?y.setError(!e(t)):g?y.setError(!g(t)):""!==t||B.required||V||y.setError(null)}h&&h(t,e)},ie=(0,i.useContext)(b.ZP),oe=e=>{var t;U&&(0,_.gu)({trackingId:U,details:{data_id:B.id,data_event:e,data_length:null===(t=y.value)||void 0===t?void 0:t.length,...ie},trackingCallback:L})};let re=(0,S.jsx)(K,{type:Y,className:$,name:y.fieldName,...r()(B,"options","bordered","includeBlank","popoverMessage"),value:void 0===N||null===N?y.value||0===y.value?y.value:"":N,onSelect:e=>{"date"===l&&!E.Z.inputtypes.date&&ne&&ne(e)},tabIndex:B.disabled?-1:void 0,onChange:ne,onBlur:e=>{y.setTouched(),oe("blur"),v&&v(e)},onFocus:e=>{oe("focus"),m&&m(e)},ref:z,autoComplete:A,onDrop:e=>W&&e.preventDefault(),onPaste:e=>F&&e.preventDefault(),maxLength:j,minLength:Z});return["string","text"].includes(Y)&&!!B.popoverMessage&&(re=(0,S.jsxs)("div",{className:"dl-display-flex dl-align-items-center dl-full-width",children:[re,(0,S.jsx)(C.default,{popoverMessage:B.popoverMessage,absolute:!0})]})),!p&&n?(0,S.jsxs)(S.Fragment,{children:[re,ee&&y.value&&(k||D(y))||te]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("span",{className:H,children:[p?"string"===typeof p?(0,S.jsx)("i",{className:"dl-input-icon icon-".concat(p)}):(0,i.cloneElement)(p,{className:c()(p.props.className,"dl-input-icon-component",{"dl-input-icon-component-error":y.touched&&!ee})}):null,re,J&&(0,S.jsx)(Q,{className:"dl-input-visibility-icon",onClick:e=>{e.preventDefault(),G((e=>{let{inputType:t}=e;return{inputType:"text"===t?"password":"text"}}))}})]}),ee&&y.value&&(k||D(y))||te]})},V=(0,p.g)((e=>(0,S.jsx)(l.gN,{...e,children:t=>{const{preValidate:n,validate:i,...o}=e;return(0,S.jsx)(M,{fieldApi:t,...o})}})))},931544:(e,t,n)=>{function i(){const e=document.querySelector('script[src*="doctor-desktop"]'),t=null===e||void 0===e?void 0:e.getAttribute("src");return t?function(e){const t=e.split("-");return t[t.length-1]}(t):null}n.d(t,{U:()=>i})},820648:(e,t,n)=>{n.d(t,{G_:()=>a,fG:()=>r});var i=n(727484),o=n.n(i);n(944908),n(227361);const r=e=>o()(e).localize("dddd DD MMMM YYYY"),a=e=>o()(e).localize("DD/MM/YYYY")},327184:(e,t,n)=>{n.d(t,{ZP:()=>u,_O:()=>l});var i=n(267711),o=n(219698),r=n(972459),a=n(667294),s=n(785893);(0,i.setLogger)({log:console.log,warn:console.warn,error:function(){console.warn("[APPLICATION ERROR caught by ReactQuery]"),console.warn(...arguments)}});const c=(0,r.ib)()?(0,o.Z)((()=>n.e(20938).then(n.t.bind(n,420938,23)).then((e=>({default:e.ReactQueryDevtools})))),"seal"):()=>null,l=(0,a.createContext)(),d=e=>{let{children:t,httpClient:n}=e;const o=(0,a.useMemo)((()=>(e=>{let{httpClient:t}=e;return new i.QueryClient({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:!1,queryFn:e=>{let{queryKey:n}=e;const[i,o]=n;return t.get(i,o).then((e=>e.bodyData))}},mutations:{retry:!1}}})})({httpClient:n})),[n]);return(0,s.jsx)(l.Provider,{value:n,children:(0,s.jsxs)(i.QueryClientProvider,{client:o,children:[t,(0,s.jsx)(c,{})]})})},u=d},178650:(e,t,n)=>{n.d(t,{R1:()=>a});var i=n(51443),o=n(194943);const r=Object.values(i.ZP).map((e=>e.kind)),a=(i.ZP.IncapacityOfWork.kind,i.ZP.PsychotherapyAgreement.kind,i.ZP.Transfer.kind,(e,t)=>t.consultation.governmental_document_type===o._C.Kbv&&r.includes(e))},742512:(e,t,n)=>{n.d(t,{kR:()=>s});var i=n(288306),o=n.n(i),r=n(441609),a=n.n(r);const s=e=>e.some((e=>e.booking_fields.some((e=>"import_identifier"===e.id&&!0===e.visible)))),c=(e,t,n)=>!(!e.required||!t&&!(e=>e?["communication_consent","import_identifier"]:["communication_consent"])(n).includes(e.id))||!!e.required&&"soft";o()((function(e,t,n){let{emailRequired:i,vaccinationBookingCodeRequired:o=!1}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{booking_fields:r,booking_fields_strictly_required:s}=t,l=r.filter((t=>{let{speciality_id:n}=t;return!n||Number(e)===Number(n)})).filter((e=>{let{ref_visit_motive_ids:t}=e;return a()(t)||t.some((e=>Number(e)===Number(n)))})).map((e=>({...e,required:c(e,s,o)})));if(i){const e=l.find((e=>"email"===e.id));e&&(e.required="soft")}const d=l.find((e=>{let{id:t}=e;return"postal_address"===t}));return l.concat([{id:"last_name",required:!0,visible:!0},{...d,id:"address"},{...d,id:"city"},{...d,id:"zipcode"}])}),((e,t,n,i)=>"".concat(e).concat(t.id).concat(n).concat(null===i||void 0===i?void 0:i.emailRequired))),o()((e=>e.reduce(((e,t)=>({...e,[t.id]:t.required})),{})))},469745:(e,t,n)=>{n.d(t,{W:()=>o});var i=n(972459);const o=n(432252).u.bind(null,(0,i.rZ)())},775459:(e,t,n)=>{n.d(t,{W:()=>r});var i=n(551663),o=n(469745);function r(e){if(!e)return"";const t=[];return e.phone_number&&t.push((0,o.W)(e.phone_number)),e.secondary_phone_number&&t.push((0,o.W)(e.secondary_phone_number)),t.join(" ".concat(i.Z.t("common.or")," "))}},614434:(e,t,n)=>{n.d(t,{AM:()=>r,DM:()=>s,ev:()=>a});var i=n(288306);function o(e){const t=e.match(/secretaryship_account_id=(\d+)/);return t?parseInt(t[1],10):null}const r=n.n(i)()((()=>{try{const e=o(window.parent.location.href);if(e)return e}catch{}return o(window.location.href)}))(),a=function(){try{if(window&&window.parent&&window.parent!==window){const e=window.parent.location.pathname.split("/"),t=e[e.length-1];return t.match("^[0-9]+$")?t:null}}catch{}return null}(),s=()=>({request:e=>(r&&(e.query={...e.query}||{},e.query.secretaryship_account_id=r),e)})},255371:(e,t,n)=>{n.d(t,{ZP:()=>g});var i=n(227361),o=n.n(i),r=n(912307),a=(n(799547),n(614434)),s=n(832520),c=n(577316),l=n(771241),d=n(933563),u=n(551663),p=n(931544),f=n(972459);const h=()=>window.location.reload(),v={unknown:{uiStyle:"error",message:u.Z.t("api.accounts.index.root.notifications.unknown_error"),action:{message:u.Z.t("api.accounts.index.root.notifications.reload_page"),onClick:h}},network:{authentication:{uiStyle:"error",message:u.Z.t("api.accounts.index.root.notifications.no_internet_click_reload"),action:{message:u.Z.t("api.accounts.index.root.notifications.reload_page"),onClick:h}},connection:{uiStyle:"error",message:u.Z.t("api.accounts.index.root.notifications.connection_error"),action:{message:u.Z.t("api.accounts.index.root.notifications.reload_page"),onClick:h}},update:{uiStyle:"error",message:u.Z.t("api.accounts.index.root.notifications.error_not_saved")}},maintenance:{uiStyle:"error",message:u.Z.t("api.accounts.index.root.notifications.maintenance")},not_found:{uiStyle:"error",message:u.Z.t("api.accounts.index.root.notifications.not_found"),action:{message:u.Z.t("api.accounts.index.root.notifications.reload_page"),onClick:h}},"danger.old_advanced_configuration_opening_edit":{uiStyle:"error",message:u.Z.t("api.accounts.index.root.notifications.old_advanced_configuration_opening_edit"),duration:12e3},"danger.old_advanced_configuration_template_create":{uiStyle:"error",message:u.Z.t("api.accounts.index.root.notifications.old_advanced_configuration_template_create"),duration:12e3},deprecated_endpoint:{uiStyle:"error",message:u.Z.t("api.accounts.index.root.notifications.deprecated_endpoint_click_to_refresh"),duration:12e3,action:{message:u.Z.t("api.accounts.index.root.notifications.reload_page"),onClick:h}}};let m=()=>null;const y={credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json; charset=utf-8","DOCTOR-DESKTOP-JS-VERSION":p.U()}},g=new r.Z({defaultFetchOptions:y,interceptors:[function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;return{responseError(t){if(!t.response)return t;let n="?redirection=".concat(encodeURIComponent(window.location.pathname+window.location.hash));return o()(t.response,"bodyData.meta.inactivity")&&(n+="&inactivity=1"),401===t.response.status&&"User not logged in"===o()(t.response,"bodyData.meta.reason")&&(window.onbeforeunload=null,window.location.href=(0,f.rl)()?"/":"/signin".concat(n)),"Wrong password provided"===o()(t.response,"bodyData.error")?t:[401,403,410,429,502].includes(t.response.status)?(e-=1,e<1&&!window.location.pathname.startsWith("/signin")&&(window.location.href="/signin".concat(n)),t):t}}}(),(0,l.Z)(),(0,d.Z)(),(0,a.DM)(),...s.Z,{responseError:e=>{const{response:t,request:n}=e;if(!t||!n)return m(v.unknown),e;if(!1===n.notification||n.aborted)return e;if(t.bodyData&&t.bodyData.notification_key)m(v[t.bodyData.notification_key]);else if(503===t.status){if(t.body.error&&t.body.description)return m({...v.maintenance,message:"".concat(t.body.error,": ").concat(t.body.description)});m(v.maintenance)}else 409===t.status&&t.bodyData.error?m({uiStyle:"error",message:t.bodyData.error}):"get"!==n.method.toLowerCase()?m(v.network.update):401===t.status?m(v.network.authentication):404===t.status?m(v.not_found):m(v.network.connection);return e}},...c.Z]})},28294:(e,t,n)=>{n.d(t,{LL:()=>c});var i=n(740504),o=n(650242),r=n(255371);const a=e=>{var t,n;let{includeUserIdentifiers:o}=e;return{...o&&{doctolib_account_id:(null===(t=window.current_account)||void 0===t?void 0:t.id)||(null===(n=window.account)||void 0===n?void 0:n.id)},doctolib_account_is_ehr:(0,i.gB)()>0,doctolib_account_ehr_variant:(0,i.jf)()}},s=(e,t)=>{let{name:n,details:i}=e,{includeUserIdentifiers:r}=t;return{...i,...a({includeUserIdentifiers:r}),name:n,eventType:o.GA}},c=function(e){let{name:t,details:n={}}=e,{includeUserIdentifiers:i=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r.ZP.post(o.PG,{body:s({name:t,details:n},{includeUserIdentifiers:i})}).catch((()=>{}))}},251297:(e,t,n)=>{n.d(t,{N3:()=>U,ZP:()=>L,_M:()=>z});var i=n(667294),o=n(527360),r=n.n(o),a=n(23279),s=n.n(a),c=n(551663),l=n(255371),d=n(443029),u=n(483496),p=n(580458),f=n(156213),h=n(444266),v=n(671784),m=n(702794),y=n(904108),g=n(798754),w=n(66212),_=n(658485),b=n(973650),k=n(715738),x=n(996974),Z=n(639711),P=n(745569),C=n(194943),E=n(972459),I=n(346276),j=n(24974),S=n(209047),R=n(148114),T=n(86899),N=n(167542),D=n(439463),M=n(775802),V=n(151180),O=n(308928),W=n(618832),F=n(803230),q=n(785893);const A=(0,i.createContext)(),z=e=>t=>{const n=(0,i.useContext)(A);return(0,q.jsx)(e,{...t,tanker:n})},U=e=>{let{children:t,account:n,debugLabel:o}=e;if(!o)throw new Error("missing debugLabel prop for TankerContextProvider");const[a,z]=(0,i.useState)(),[U,L]=(0,i.useState)(),{account:B}=(0,i.useContext)(d.Z),{tankerIsUp:X}=(0,i.useContext)(P.ZP),G=n||B,Y=(0,i.useRef)(null),K=(0,i.useRef)(null),Q=(0,i.useRef)({});(0,i.useEffect)((()=>{(0,b.X)(l.ZP,w.Iz,{sendTrackingEvent:!1,tankerContextDebugLabel:o,propAccount:{present:null!=n,id:null===n||void 0===n?void 0:n.id,kind:null===n||void 0===n?void 0:n.kind},contextAccount:{present:null!=B,id:null===B||void 0===B?void 0:B.id,kind:null===B||void 0===B?void 0:B.kind}})}),[n,null===n||void 0===n?void 0:n.id,null===n||void 0===n?void 0:n.kind,B,null===B||void 0===B?void 0:B.id,null===B||void 0===B?void 0:B.kind,o]);const{startTanker:J,pretendToStartTanker:H,initializeTanker:$}=(0,j.O)({httpClient:l.ZP,startRegistration:async function(e,t){if(!X)return;const{optout:n}=await async function(e){return ee("verification_info",e)}(t);if(n)return;await ae(e,"registerIdentity",t)},validateIdentity:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return ae(e,"verifyIdentity",t,n)},postStartChecks:async function(e,t,n){const{module:{Tanker:i}}=e,o=await async function(e,t,n){var i;const{setEmailVerification:o,forceCodeEmailVerification:r,allowEmailModification:a,hideModals:s}=n;if(null!==(i=e.tanker_identity)&&void 0!==i&&i.oidc_registered_at)return!1;if(!(await async function(e,t){const n=await(0,h.SR)(t.tanker);return e.email.toLowerCase()!==(null===n||void 0===n?void 0:n.toLowerCase())}(e,t)))return await(0,h.dG)(l.ZP,e),!1;const{success:c,error:d}=await re(t,"setVerificationMethod",e,o,r,a,s);if(c)return await(0,h.dG)(l.ZP,e),!0;d&&await async function(e,t,n){const{module:{errors:i}}=t;if(n instanceof i.ExpiredVerification)return void(await async function(e,t){const{success:n}=await async function(e){return ee("verification_expired_link",e)}(e);n&&await re(t,"setVerificationMethod",e)}(e,t));throw(0,b.X)(l.ZP,w.Rd,{account:e,error:n}),n}(e,t,d);return!1}(t,e,n);if((0,v.a)(e,t)&&!t.two_factor_auth_response){const n=await(0,R.M)(e,l.ZP,t);n.filter((e=>{let{status:t}=e;return t===i.statuses.READY})).length>0&&(0,T.J)(e,l.ZP,t)}o&&await te(e,t,n.hideModals)}});async function ee(e,t){return new Promise((n=>{z({subject:e,account:t,onSuccess:()=>{z(null),n({success:!0})},onClose:()=>{z(null),n({optout:!0})}})}))}async function te(e,t,n){let{tanker:i}=e,o=!0;return sessionStorage.getItem("deviceId")&&(o=sessionStorage.getItem("deviceId")===i.deviceId),new Promise((e=>{z({subject:"verification_success",account:t,isSameDevice:o,hideModals:n,onSuccess:()=>{z(null),sessionStorage.removeItem("deviceId"),(0,b.X)(l.ZP,w.zM,{account:t}),e({success:!0})},onClose:()=>{z(null),e({optout:!0})}})}))}const ne=!(null!==G&&void 0!==G&&G.assumed_authorizations_organization||null!==G&&void 0!==G&&G.assumed_authorizations_account||null!==G&&void 0!==G&&G.real_staff||null!==G&&void 0!==G&&G.has_only_sandbox_organization);async function ie(e,t,n){try{return await e[t](n),{success:!0}}catch(i){return{success:!1,error:i}}}function oe(e){let{email:t,...n}=e;return t=t.toLowerCase(),{...n,email:t}}async function re(e,t,n,i,o){let r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];const{tanker:d,module:{Tanker:u,errors:p}}=e;let v=n.email.toLowerCase();const m=await(0,h.SR)(d);if("verifyIdentity"===t&&(v=m,!m))throw new Error("No email set as verification method yet.");return i?ie(d,t,oe(i)):new Promise((e=>{const i=["/account/appointments","/account/documents","/confirmed-appointment"].some((e=>window.location.pathname.includes(e))),h="verifyIdentity"===t||i||o?"verifyWithCode":null;z({subject:"email_code",method:t,account:n,email:v,verifiedEmail:m,verifyWithCode:h,hideModals:a,sendEmailOnShow:!0,displayChangeEmail:r&&d.status!==u.statuses.IDENTITY_VERIFICATION_NEEDED,sendEmail:async()=>{try{const e=d.status===u.statuses.READY?null===d||void 0===d?void 0:d.deviceId:"unknown",{bodyData:t}=await l.ZP.post("/api/security/tanker_identities/send_verification_email",{body:{email:v,device_id:e,method:h?"verifyWithCode":null}});"verification_code"in t&&(0,_.IG)(v,t.verification_code)}catch(e){(0,b.X)(l.ZP,w.qH,{account:n,error:e}),L(c.Z.t("api.accounts.index.root.notifications.temporary_error")),(0,f.T)(e)}},onSuccess:s()((async i=>{L(null);try{await d[t]({email:v,verificationCode:i}),z(null),(0,b.X)(l.ZP,w.BS,{account:n}),e({success:!0})}catch(o){o instanceof p.InvalidVerification?((0,b.X)(l.ZP,w.NJ,{account:n,error:o}),L(c.Z.t("tanker.wrong_code"))):o instanceof p.TooManyAttempts?((0,b.X)(l.ZP,w.UE,{account:n,error:o}),L(c.Z.t("tanker.errors.too_many_attempts"))):o instanceof p.ExpiredVerification?((0,b.X)(l.ZP,w.O7,{account:n,error:o}),L(c.Z.t("tanker.errors.expired_verification"))):((0,b.X)(l.ZP,w.Ql,{account:n,error:o}),L(c.Z.t("api.accounts.index.root.notifications.temporary_error")),(0,f.T)(o))}}),500),onClose:()=>{L(null),z(null),e({optout:!0})}})}))}async function ae(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const{tanker:o}=e,r="verifyIdentity"===t&&await(0,h.SR)(o);return new Promise((o=>{z({subject:"password",method:t,account:n,onSuccess:s()((async r=>{L(null);try{const a=(await l.ZP.post("/api/password/verify",{body:r})).bodyData.match,{password:s}=r;if(!a)return(0,b.X)(l.ZP,w.iC,{account:n}),void L(c.Z.t("doctor_common.pin_code.reconnect.errors.wrong_password"));const d=await se({account:n,tankerState:e,billeoOnly:i,method:t,password:s});o({success:d})}catch(a){o({success:!1,error:a})}}),500),onClose:()=>{L(null),z(null),o({optout:!0})},onVerifyByEmail:r?async()=>{L(null);const t=await re(e,"verifyIdentity",n);t.success&&await te(e,n),o(t)}:null})}))}async function se(e){let{account:t,tankerState:n,billeoOnly:i,method:o,password:r}=e;const{tanker:a,module:{errors:s}}=n;try{return i||await a[o]({passphrase:r}),z(null),await async function(e){let{account:t,password:n}=e;const i=k.ZP.PRODUCT_LINE_CONFIG.find((e=>e.configuration_variant===((null===t||void 0===t?void 0:t.ehr_variant)||"without-ehr")));if(null!==t&&void 0!==t&&t.ehr_subscription&&(null===i||void 0===i?void 0:i.billing.paramedic)===C.ay.Enabled&&k.ZP.TANKER_BILLEO_ENABLED&&K.current&&Y.current){const e=await Y.current(t.tanker_identity.value);if(!e||"Ok"!==e.type||!e.result){const e=await K.current(t.tanker_identity.value,n);e&&"Ok"===e.type&&e.result||L(c.Z.t("tanker.errors.failure_billeo"))}}}({account:t,password:r}),!0}catch(p){var d,u;if(p instanceof s.InvalidVerification&&"verifyIdentity"===o&&await(0,h.SR)(a)){const{success:e}=await re(n,"verifyIdentity",t);if(e)return await a.setVerificationMethod({passphrase:r}),!0}else p instanceof s.TooManyAttempts?((0,b.X)(l.ZP,w.UE,{account:t,error:p}),L(c.Z.t("tanker.errors.too_many_attempts"))):null!==(d=p.message)&&void 0!==d&&d.startsWith("A user with this ID already exists")?((0,b.X)(l.ZP,w.zu,{account:t,error:p}),L(c.Z.t("api.accounts.index.root.notifications.reload_page_to_fix_error"))):null!==(u=p.message)&&void 0!==u&&u.startsWith("Expected status IDENTITY")?((0,b.X)(l.ZP,w.A7,{account:t,error:p}),L(c.Z.t("api.accounts.index.root.notifications.reload_page_to_fix_error"))):((0,b.X)(l.ZP,w.Q,{account:t,error:p}),L(c.Z.t("api.accounts.index.root.notifications.temporary_error")),(0,f.T)(p))}return!1}async function ce(e,t){const{tanker:n}=await $(e);return await fe(n,t),J(e,{verificationMethod:t,byPassPostStartChecks:!0})}async function le(e){var t;if(!X||null!==e&&void 0!==e&&e.show_pin_set||null!==e&&void 0!==e&&e.freemium||e.first_sign_in&&e.hcp_first_sign_in_enabled||"true"===r().get("tanker_opt_out")&&(null===(t=e.tanker_identity)||void 0===t||!t.email_registered_at))return;const{tanker:n,module:i}=await J(e);n.status===i.Tanker.statuses.READY&&(await de(e),await async function(e){const t=localStorage.getItem(p.Qz);if(!t||t<Date.now()-p.B8){const t=await(0,m.RW)(l.ZP,"doctor");await(0,m.Kh)(e,l.ZP,t,"doctor"),localStorage.setItem(p.Qz,Date.now())}}(n))}async function de(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const{tanker:n}=await J(e,t);await(0,y.mh)(e,n,l.ZP)}catch(n){"InvalidVerification"===n.name?await de(e):(0,b.X)(l.ZP,w.GD,{account:e,error:n})}}async function ue(){const e=await(0,m.RW)(l.ZP,"patient");if(e.length>0){const{tanker:t}=await J(G);(0,m.Kh)(t,l.ZP,e,"patient")}}function pe(){return J(G)}async function fe(e,t){if(!(0,E.IF)())return null;if(!("oidcIdToken"in t))return null;const n=await(0,I.x)();return e.setOidcTestNonce(n)}function he(e){return(0,i.useCallback)((function(){return Q.current[e](...arguments)}),[e])}(0,i.useEffect)((()=>{ne&&("doctor"===(null===G||void 0===G?void 0:G.kind)&&le(G).catch((async e=>{let t;try{t={status:(await fetch("https://api.tanker.io/v2/apps/SZf3ucySWwJVXO8hdVpR3wue_f8HwYYhtPHj173PgHc/users/KZsa6nEUKQDRm0aMnJy6cWCg7dWY9fnlmH2jAf9m03c")).status}}catch(e){t={message:e.message}}(0,b.X)(l.ZP,w.Ye,{account:G,error:e,tankerCallTracking:t,site:"initDoctor",sendTrackingEvent:!1,sendNewRelicEvent:!0})})),"patient"===(null===G||void 0===G?void 0:G.kind)&&async function(e){var t;if(sessionStorage.getItem("tankerEmailVerificationCode")){const t={email:e.email,verificationCode:sessionStorage.getItem("tankerEmailVerificationCode")};sessionStorage.removeItem("tankerEmailVerificationCode"),await J(e,{setEmailVerification:t})}null!==(t=e.tanker_identity)&&void 0!==t&&t.email_registered_at&&await ue()}(G))}),[null===G||void 0===G?void 0:G.id]),Q.current.encryptFile=O.P.bind(null,pe,l.ZP,G),Q.current.decryptFile=(0,g._)(W.n.bind(null,{setModalProps:z,setModalError:L,showSuccessModal:te,httpClient:l.ZP,startTanker:J,account:G,tankerIsUp:X})),Q.current.encryptRecordV2=V.y.bind(null,pe,l.ZP,G),Q.current.decryptRecordV2=M.J.bind(null,pe,l.ZP,G),Q.current.encryptRecordV1=D._.bind(null,l.ZP,ne,Q.current.encryptRecordV2),Q.current.decryptRecordV1=(0,g._)(N.t.bind(null,ne,Q.current.decryptRecordV2)),Q.current.getResourceId=S.f.bind(null,pe,l.ZP),Q.current.shareResourceWith=(0,g._)((async function(e,t){let{enforceFullRegistration:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=await J(G,{enforceFullRegistration:n});if(n&&!(0,v.a)(i,G))throw new Error("Tanker full registration required");return(0,y.Q5)(i.tanker,e,t,l.ZP)})),Q.current.checkTankerStatus=async function(e){const{pretendedStatus:t,verifiedEmail:n}=await H(e);return{pretendedStatus:t,verifiedEmail:n}},Q.current.startTanker=J,Q.current.startTankerWithVerificationMethod=ce,Q.current.setVerificationMethod=async function(e,t){const{tanker:n}=await J(e);await fe(n,t);try{return await(0,F.B)({account:e,verificationMethod:t,httpClient:l.ZP,tanker:n})}catch(i){throw(0,b.X)(l.ZP,w.lN,{account:e,error:i}),i}},Q.current.updatePassphraseVerificationMethod=async function(e){let{account:t,currentPassword:n,newPassword:i,trackingOrigin:o}=e;try{if(!X)throw new Error("Tanker is down!");const{tanker:e}=await ce(t,{passphrase:n});await e.setVerificationMethod({passphrase:i}),(0,b.X)(l.ZP,w.Wh,{account:t,origin:o})}catch(r){(0,f.T)(r),(0,b.X)(l.ZP,w.GW,{account:t,error:r,origin:o})}},Q.current.refreshGroups=de;const ve=he("encryptFile"),me=he("decryptFile"),ye=he("encryptRecordV1"),ge=he("decryptRecordV1");ye.v2=he("encryptRecordV2"),ge.v2=he("decryptRecordV2");const we=he("getResourceId"),_e=he("shareResourceWith"),be=he("checkTankerStatus"),ke=he("startTanker"),xe=he("startTankerWithVerificationMethod"),Ze=he("setVerificationMethod"),Pe=he("updatePassphraseVerificationMethod"),Ce=he("refreshGroups"),Ee=(0,i.useMemo)((()=>({shouldUseTanker:ne,checkTankerStatus:be,startTanker:ke,startTankerWithVerificationMethod:xe,setVerificationMethod:Ze,updatePassphraseVerificationMethod:Pe,encryptRecord:ye,decryptRecord:ge,encryptFile:ve,decryptFile:me,getResourceId:we,shareResourceWith:_e,refreshGroups:Ce,billeoVerificationTanker:Y,billeoRegistrationTanker:K,modalProps:a,modalErrorMessage:U})),[ne,be,ke,xe,Ze,Pe,ye,ge,ve,me,we,_e,Ce,U,a]),Ie=(0,x.GV)()?i.Fragment:Z.VK;return(0,q.jsxs)(A.Provider,{value:Ee,children:[t,(0,q.jsx)(Ie,{children:(0,q.jsx)(u.Z,{modalProps:a,modalErrorMessage:U,setModalError:L})})]})},L=A},745569:(e,t,n)=>{n.d(t,{Ik:()=>w,ZP:()=>_});var i,o=n(667294),r=n(255371),a=n(17851),s=n(443029),c=n(567451),l=n(551663),d=n(651120),u=n(785893);const p=!0,f=(null===(i=window.tanker_status)||void 0===i?void 0:i.poll_interval)||18e4,h=(0,o.createContext)();function v(e){switch(e){case"up":return!0;case"down":return!1;default:return p}}async function m(e){e({tankerIsUp:await async function(){const e=await r.ZP.get("/api/tanker_status.json");if(200!==e.status)return p;const{tanker_status:t}=e.bodyData;return v(t)}()})}function y(e){const[t,n]=(0,o.useState)(window.tanker_status?{tankerIsUp:v(null===(i=window.tanker_status)||void 0===i?void 0:i.tanker_status)}:(console.log("initial tanker state was not found in window object"),{tankerIsUp:p}));var i;return(0,o.useEffect)((()=>{if(null!==e&&void 0!==e&&e.tanker_e2ee_enabled)return function(e){const t=window.setInterval((()=>m(e)),f);return()=>window.clearInterval(t)}(n)}),[e]),(0,d.Z)(t)}const g=e=>{let{account:t}=e;const[n,i]=(0,o.useState)(null),{tankerIsUp:r}=(0,o.useContext)(h),{add:s,remove:d}=(0,o.useContext)(a.uL);return(0,o.useEffect)((function(){if(null===t||null!==t&&void 0!==t&&t.show_pin_set)return u;if(r&&null!==n)d(n),i(null);else if(!r&&null===n){const e=s({uiStyle:"error",message:l.Z.t("api.accounts.index.root.notifications.temporary_error"),duration:c.wD});i(e)}return u}),[r,t]),null;function u(){null!==n&&d(n)}};var w=e=>{let{children:t,account:n}=e;const{account:i}=(0,o.useContext)(s.Z),r=n||i,a=y(r);return(0,u.jsxs)(h.Provider,{value:a,children:[t,(0,u.jsx)(g,{account:r})]})};const _=h},658485:(e,t,n)=>{n.d(t,{IG:()=>u,Lu:()=>a,eK:()=>d,hG:()=>c,jx:()=>l,q6:()=>s});var i=n(156213),o=n(682492),r=n.n(o);class a extends Error{constructor(e,t){super(e),this.requestUrl=t.url,this.responseStatusCode=t.status,this.responseRedirectLocation=t.headers.get("location"),this.responseContentType=t.headers.get("content-type")}}class s extends a{}class c extends Error{}function l(e,t){Object.defineProperty(e.prototype,"name",{value:t})}function d(e){try{const t={tags:{team:"DAP"}};(0,i.T)(e,t),e.next&&(0,i.T)(e.next,r()(t,{tags:{unwrappedName:e.name,unwrappedMessage:e.message}}))}catch(e){}}l(a,"RequestError"),l(s,"IdentityUpdateError"),l(c,"NoPermissionToDecryptError");const u=(e,t)=>{console.info("%cThe Tanker email verification code for %c%s %cis %c%s","font-size: 140%;","font-size: 140%; font-weight: bold;",e,"font-size: 140%;","font-size: 140%; font-weight: bold;",t)}},578682:(e,t,n)=>{n.d(t,{Z:()=>y});var i=n(667294),o=n(294184),r=n.n(o),a=n(808514),s=n(481094),c=n(768593),l=n(551663),d=n(558613),u=n(736820),p=n(469430),f=(n(21374),n(515539)),h=n(785893);function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class m extends i.Component{constructor(e){var t;super(e),v(this,"handleChange",(e=>{var t,n;null===(t=(n=this.props).onChange)||void 0===t||t.call(n,e),null==this.props.value&&this.setState({value:e.target.value})})),v(this,"handleBlur",(e=>{var t;this.track({data_event:"blur",data_length:null===(t=e.target.value)||void 0===t?void 0:t.length}),this.props.onBlur&&this.props.onBlur(e)})),v(this,"handleFocus",(e=>{var t;this.track({data_event:"focus",data_length:null===(t=e.target.value)||void 0===t?void 0:t.length}),this.props.onFocus&&this.props.onFocus(e)})),v(this,"handleWheel",(e=>{this.props.onWheel&&this.props.onWheel(e)})),v(this,"enhancedInputRefFunction",(e=>{this.input={current:e},this.props.inputRef(e)})),v(this,"getRef",(()=>{const{inputRef:e}=this.props;return"function"===typeof e?this.enhancedInputRefFunction:(this.input=e||(0,i.createRef)(),this.input)})),v(this,"onPressUp",(()=>{const{disabled:e,readOnly:t}=this.props;e||t||(this.input.current.focus(),this.input.current.stepUp(),this.input.current.dispatchEvent(new Event("change",{bubbles:!0})))})),v(this,"onPressDown",(()=>{const{disabled:e,readOnly:t}=this.props;e||t||(this.input.current.focus(),this.input.current.stepDown(),this.input.current.dispatchEvent(new Event("change",{bubbles:!0})))})),v(this,"toggleShowPassword",(()=>{const{disabled:e,readOnly:t}=this.props;e||t||(this.input.current.focus(),this.setState((e=>{let{showPassword:t}=e;return{showPassword:!t}})))}));const{value:n,defaultValue:o}=e;this.state={value:null!==(t=null!==n&&void 0!==n?n:o)&&void 0!==t?t:"",showPassword:!1}}static getDerivedStateFromProps(e,t){return null==e.value?{...t}:{...t,value:e.value}}componentDidMount(){"date"===this.props.type&&(0,s.Z)()}track(e){this.props.trackingId&&(0,c.gu)({trackingId:this.props.trackingId,details:{data_id:this.props.id,...this.props.trackingEventDetailsContext,...e}})}render(){var e;const{className:t,containerClassName:n,disabled:o,focused:s,icon:c,iconFeedbackWhenFilled:d,iconPosition:v,inputRef:m,label:y,leftIcon:g,leftIconTooltip:w,message:_,multiline:b,autosize:k,optional:x,readOnly:Z,required:P,rightIcon:C,type:E,hasUpAndDownButtons:I,trackingId:j,trackingEventDetailsContext:S,uiStyle:R,validationState:T,defaultValue:N,...D}=this.props,{showPassword:M}=this.state,V=r()("dl-input","dc-input","form-control",t,{"dl-input-number":"number"===E,"dl-input-date":"date"===E,["dl-input-".concat(R)]:R,"dl-input-multiline":b,"dl-input-autosize":k,"dl-input-focused":s,"dl-input-with-icon":c,"dl-input-with-left-icon":g,"dl-input-with-right-icon":C||"password"===E,"dl-input-validation-success":"success"===T,"dl-input-validation-error":"error"===T,"dl-input-validation-warning":"warning"===T}),O=k?a.Z:b?"textarea":"input",W=(0,h.jsx)(O,{...D,value:null!==(e=D.value)&&void 0!==e?e:this.state.value,className:V,onChange:this.handleChange,onBlur:this.handleBlur,onFocus:this.handleFocus,onWheel:this.handleWheel,ref:this.getRef(),readOnly:Z,required:P,disabled:o,type:M?"text":E});if(c){const e=r()("dl-input-container",{"dl-input-container-filled":d&&Boolean("string"!==typeof this.props.value?this.state.value:this.props.value)},"dl-input-container-icon-position-".concat(v));return(0,h.jsxs)("span",{className:e,children:["string"===typeof c?(0,h.jsx)("i",{className:"dl-input-icon icon-".concat(c)}):(0,i.cloneElement)(c,{className:r()(c.props.className,"dl-input-icon-component")}),W]})}return y||_||g||C||"number"===E||"password"===E?(0,h.jsxs)("div",{className:r()("dl-full-width",n),children:[!!y&&(0,h.jsxs)("div",{className:r()("dl-display-flex",{"dl-align-items-baseline":x}),children:[(0,h.jsx)(u.Z,{className:"dl-input-label",uiStyle:"body-s-bold",children:y}),P&&(0,h.jsx)(u.Z,{className:"dl-margin-l-4",uiStyle:"body-xs-bold",color:"neutral-090",children:"*"}),x&&(0,h.jsxs)(u.Z,{className:"dl-margin-l-4",uiStyle:"body-xs-regular",color:"neutral-090",children:["(",l.Z.t("common.fields.optional"),")"]})]}),(0,h.jsxs)("div",{className:"dl-position-relative",children:[!!g&&(!w&&(0,h.jsx)(p.Z,{className:"dl-input-left-icon",name:g})||(0,h.jsx)(f.Z,{placement:"top",className:"dl-input-left-icon dl-pointer-events-all",tooltip:w,children:(0,h.jsx)(p.Z,{name:g})})),W,"password"===E&&(0,h.jsx)("div",{className:"dl-input-right-icon dl-input-password-icon",onClick:this.toggleShowPassword,children:(0,h.jsx)(p.Z,{name:M?"eye":"eye-crossed"})}),!!C&&(0,h.jsx)(p.Z,{className:"dl-input-right-icon",name:C}),"number"===E&&I&&(0,h.jsxs)("div",{className:"dl-input-number-buttons-container",children:[(0,h.jsx)("div",{disabled:o,onClick:this.onPressUp,className:"dl-input-number-button",role:"button","aria-label":"Increment",children:(0,h.jsx)(p.Z,{name:"solid/chevron-up"})}),(0,h.jsx)("div",{disabled:o,onClick:this.onPressDown,className:"dl-input-number-button",role:"button","aria-label":"Decrement",children:(0,h.jsx)(p.Z,{name:"solid/chevron-down"})})]})]}),!!_&&(0,h.jsx)(u.Z,{block:!0,className:"dl-input-message",uiStyle:"body-xs-regular",color:"error"===T?"error-090":"neutral-090",children:_})]}):W}}v(m,"defaultProps",{focused:!1,iconFeedbackWhenFilled:!1,iconPosition:"right",multiline:!1,autosize:!1,type:"text",uiStyle:"default",hasUpAndDownButtons:!0});const y=(0,d.lG)(m)},735156:(e,t,n)=>{n.d(t,{DC:()=>d,E$:()=>f,R0:()=>p,nc:()=>c,q$:()=>h,rz:()=>l});var i=n(727484),o=n.n(i),r=n(747037),a=n.n(r),s=n(906396);const c=e=>{return e&&(e instanceof Date||(t=e,a()(t)&&(s.fZ.test(t)||s.$J.test(t))))?o().utc(e).format(s.P9.long):e;var t},l=e=>{const t=o().utc(e),n=t.isSameOrAfter(o().utc("1900-01-01")),i=t.isSameOrBefore(o().utc());return n&&i},d=e=>(e.isAfter(o().utc())&&(e=e.subtract(100,"year")),e),u=e=>{const t=o().utc(e,s.P9.short,!0);return t.isValid()?d(t):null},p=e=>{if(!e)return null;const t=o().utc(e,s.P9.long,!0);return t.isValid()?t:u(e)},f=e=>{const t=p(e);return t&&l(t)?t.toDate():null},h=e=>{const t=u(e);return t?t.format(s.P9.long):null}},292818:(e,t,n)=>{n.d(t,{Z:()=>u});var i=n(785893),o=n(667294),r=n(294184),a=n.n(r),s=n(659864),c=n(823592),l=n(848766),d=n(469430);n(738031);const u=(0,o.forwardRef)(((e,t)=>{let{bgColor:n="white",variant:o="default",DEPRECATED_floating:r=!1,DEPRECATED_horizontal:u=!1,DEPRECATED_picture:p,border:f=!1,children:h,className:v,contentClassName:m,disabled:y,fullWidth:g,header:w,headerProps:_,iconName:b,scrollable:k,component:x="div",onTap:Z,...P}=e;const C={};let E=x;Z&&(E=c.Z,C.component=x,C.role="button",C.tabIndex=0,C.onTap=Z);const I=o||Z&&"default"||!1,j=a()("dl-card","dl-card-bg-".concat(n),{["dl-card-variant-".concat(I)]:I,"dl-card-border":f,"dl-card-horizontal":u,"dl-card-floating":r&&!y,"dl-card-fullwidth":g,"dl-card-tappable":Z&&!y,"dl-card-disabled":y,"dl-padding-0":!!w},v);return"string"===typeof E||(0,s.isForwardRef)(E)?C.ref=t:C.innerRef=t,(0,i.jsxs)(E,{className:j,...P,...C,children:[w&&(0,i.jsx)(l.Z,{..._,flatTop:g,children:w}),p&&(0,i.jsx)("div",{className:"dl-card-picture dl-position-relative",children:p}),(0,i.jsx)("div",{className:a()("dl-card-content",{"dl-card-content-horizontal":u,"dl-card-content-scrollable":k},m),children:h}),b&&(0,i.jsx)("div",{className:"dl-card-icon",children:(0,i.jsx)(d.Z,{name:b,className:"dl-card-icon-i",size:"medium","aria-hidden":"true"})})]})}))}}]);
//# sourceMappingURL=95204-5cbedafd9c1e7127f4ef.js.map